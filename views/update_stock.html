<link href="../css/select2.css" rel="stylesheet"/>
    <script src="../js/select2.js"></script>
<?php 
$store_id = sanitize_string($_GET['st_id']);

?>
<script>
$(document).ready(function(){	
$("#mat_name").select2(); 
$("#sup_name").select2(); 
//hide all errors when form loads
$("#mat_name_error").hide();
$("#sup_name_error").hide();
$("#qty_error").hide();
$("#desc_error").hide();
$("#response").hide();
$(".loader").hide();
//check if submit button has been clicked
		$("#submit").click(function(e){
		e.preventDefault();
		$("#response").empty();
		//error
		error = false;
		mat_name = $("#mat_name").val();
		sup_name = $("#sup_name").val();
	    qty = $("#qty").val();
		store = <?php echo $store_id;?>;
		 desc = $("#desc").val();
		//validate data
	  if(desc ===''){
		error =true;
		$("#desc_error").fadeIn();
		$("#desc").focus();
		}else{
		$("#desc_error").fadeOut();		
		}	
		if(qty ===''){
		error =true;
		$("#qty_error").fadeIn();
		$("#qty").focus();
		}else{
		$("#qty_error").fadeOut();		
		}
	  if(sup_name ===''){
		error =true;
		$("#sup_name_error").fadeIn();
		$("#sup_name").focus();
		}else{
		$("#sup_name_error").fadeOut();
		
		}
		if(mat_name ===''){
		error =true;
		$("#mat_name_error").fadeIn();
		$("#mat_name").focus();
		}else{
		$("#mat_name_error").fadeOut();
		
		}
		
		//if no errors send request to server
		if(error ==false){
		//hide submit button
		$("#submit").fadeOut();
		$(".loader").fadeIn();
		
		/* Ajax Request here*/
					//data values
			var myData = 'mat_name='+mat_name +  '&qty='+ qty  + '&desc='+ desc + '&store='+ store + '&site_id='+ <?php echo sanitize_string($_GET['site_id']); ?> + '&sup_name='+ sup_name ; //build a post data structure
			jQuery.ajax({
			type: "POST", // Post / Get method
			url: "../process/update_stock.php", //Where form data is sent on submission
			dataType:"text", // Data type, HTML, json etc.
			data:myData, //Form variables
			success:function(response){
			$("#response").append(response); 
			$('.loader').fadeOut();
			$('#submit').fadeIn();
			$('#response').fadeIn();
			}

			});
		}
		
		});
});	

</script>	


		<div class="col-sm-4" style="background-color:#fff;border:2px solid #616A6B;">
					<div class="signup-form">
						<h3>Update Stock</h3>
						<form action="../process/update_stock.php" method="POST">
						 <span class="error" id="mat_name_error">* Choose Materials</span><br/>
							<label>Material</label>
							<select name="mat_name" id="mat_name" style="width:100%">
								<option value="">--Select Material--</option>
								<?php
								
								$qr = mysql_query("select * from materials_stock as ms left join materials as mt on mt.mat_id = ms.mat_id
								where ms.store_id='$store_id' order by mt.mat_name asc");
								while($qrow=mysql_fetch_assoc($qr)){
								
								?>
								<option value="<?php echo $qrow['mat_id'];?>"><?php echo $qrow['mat_name'];?></option>
								<?php
								}
								?>
							</select><br/></br>	
	 <span class="error" id="sup_name_error">* Choose Supplier</span><br/>
							<label>Supplier</label>
							<select name="sup_name" id="sup_name" style="width:100%">
								<option value="">--Select Supplier--</option>
								<?php
								
								$qr = mysql_query("select * from suppliers where status='Active' order by sup_name asc");
								while($qrow=mysql_fetch_assoc($qr)){
								
								?>
								<option value="<?php echo $qrow['sup_id'];?>"><?php echo $qrow['sup_name'];?></option>
								<?php
								}
								?>
							</select><br/></br>								
		                      <span class="error" id="qty_error">* Quantity</span><br/>
							<label>Quantity:</label>
							<input type="text" name="qty" id="qty" placeholder="Quantity"/>                        
							<span class="error" id="desc_error">* Description</span><br/>
							<label>Description:</label>
							<input type="text" name="desc" id="desc" placeholder="Description"/>						
							<button type="submit" id="submit" class="btn btn-default">Update Stock</button>
							<span class="loader"><img src="../images/loader.gif" width="50px" height="50px"/>Processing Request...</span>
							<div id="response"></div>
						</form>
					</div>
				</div>