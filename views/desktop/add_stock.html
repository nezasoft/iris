<link href="../css/select2.css" rel="stylesheet"/>
    <script src="../js/select2.js"></script>
<?php 
$store_id = sanitize_string($_GET['st_id']);
?>
<script>
$(document).ready(function(){
$("#mat_name").select2();
$("#pack_name").select2(); 
//hide all errors when form loads
$("#mat_name_error").hide();
$("#pack_name_error").hide();
$("#qty_error").hide();
$("#desc_error").hide();
$("#min_stock_error").hide();
$("#max_stock_error").hide();
$("#response").hide();
$(".loader").hide();
//check if submit button has been clicked
		$("#submit").click(function(e){
		e.preventDefault();
		$("#response").empty();
		//error
		error = false;
		mat_name = $("#mat_name").val();
		pack_name = $("#pack_name").val();
	    qty = $("#qty").val();
		min_stock = $("#min_stock").val();
		max_stock = $("#max_stock").val();
		store = <?php echo $store_id;?>;
		desc = $("#desc").val();
		//validate data
	  if(desc ===''){
		error =true;
		$("#desc_error").fadeIn();
		$("#desc").focus();
		}else{
		$("#desc_error").fadeOut();		
		}
		 if(max_stock ===''){
		error =true;
		$("#max_stock_error").fadeIn();
		$("#max_stock").focus();
		}else{
		$("#max_stock_error").fadeOut();		
		}
		 if(min_stock ===''){
		error =true;
		$("#min_stock_error").fadeIn();
		$("#min_stock").focus();
		}else{
		$("#min_stock_error").fadeOut();		
		}
		 if(qty ===''){
		error =true;
		$("#qty_error").fadeIn();
		$("#qty").focus();
		}else{
		$("#qty_error").fadeOut();		
		}
	  if(pack_name ===''){
		error =true;
		$("#pack_name_error").fadeIn();
		$("#pack_name").focus();
		}else{
		$("#pack_name_error").fadeOut();		
		}
		if(mat_name ===''){
		error =true;
		$("#mat_name_error").fadeIn();
		$("#mat_name").focus();
		}else{
		$("#mat_name_error").fadeOut();		
		}		
		//if no errors send request to server
		if(error ==false){
		//hide submit button
		$("#submit").fadeOut();
		$(".loader").fadeIn();		
          /* Ajax Request here*/
		  //data values
			var myData = 'mat_name='+mat_name + '&pack_name='+pack_name + '&qty='+ qty  + '&desc='+ desc + '&min_stock='+ min_stock  + '&max_stock='+ max_stock + '&store='+ store + '&site_id='+ <?php echo sanitize_string($_GET['site_id']); ?> ; //build a post data structure
			jQuery.ajax({
			type: "POST", // Post / Get method
			url: "../process/new_stock.php", //Where form data is sent on submission
			dataType:"text", // Data type, HTML, json etc.
			data:myData, //Form variables
			success:function(response){
			$("#response").append(response); 
			$('.loader').fadeOut();
			$('#submit').fadeIn();
			$('#response').fadeIn();
			}

			});
		}
		
		});
});	
</script>
<hr/>
<div class="col-sm-4" style="background-color:#fff;border:2px solid #616A6B;">
<h3>Add New Stock</h3>
<table width="100%" border="0">
  <tr>
    <td>&nbsp;</td>
    <td>&nbsp;</td>
    <td>&nbsp;</td>
    <td>&nbsp;</td>
  </tr>
  <tr height="40">
    <td><div align="right"><strong>Material:</strong></div></td>
    <td><select name="mat_name" id="mat_name" style="width:200px;">
      <option value="">--Select Material--</option>
      <?php								
	    $qr = mysql_query("select * from materials group by mat_name order by mat_name asc");
		while($qrow=mysql_fetch_assoc($qr)){								
       ?>
      <option value="<?php echo $qrow['mat_id'];?>"><?php echo titleCase($qrow['mat_name']);?></option>
      <?php
	 }
     ?>
    </select><br/>
    <span class="error" id="mat_name_error">* Choose Materials</span>
    </td>
    <td><div align="right"><strong>Min. Stock Level:</strong></div></td>
    <td><input type="text" name="min_stock" id="min_stock" class="my-form-control" style="width:200px;" placeholder="Min Stock Level"/><span class="error" id="min_stock_error">* Min Stock Level</span></td>
  </tr>
  <tr height="40">
    <td><div align="right"><strong>Package:</strong></div></td>
    <td><select name="pack_name" id="pack_name" style="width:200px;">
      <option value="">--Select Package--</option>
      <?php								
		$qr = mysql_query("select * from packages group by pack_name order by pack_name asc");
		while($qrow=mysql_fetch_assoc($qr)){								
		?>
      <option value="<?php echo $qrow['pack_id'];?>"><?php echo titleCase($qrow['pack_name']);?></option>
      <?php
	   }
	  ?>
    </select><br/><span class="error" id="pack_name_error">* Choose Package</span>
    </td>
    <td><div align="right"><strong>Max. Stock Level:</strong></div></td>
    <td><input type="text" name="max_stock" id="max_stock" class="my-form-control" style="width:200px;" placeholder="Max Stock Level"/><span class="error" id="max_stock_error">* Max Stock Level</span></td>
  </tr>
  <tr height="40">
    <td><div align="right"><strong>Quantity:</strong></div></td>
    <td><input type="text" name="qty" id="qty" placeholder="Quantity" class="my-form-control" style="width:200px;"/><span class="error" id="qty_error">* Quantity</span></td>
    <td><div align="right"><strong>Description:</strong></div></td>
    <td><input type="text" name="desc" id="desc" placeholder="Description" class="my-form-control" style="width:200px;"/><span class="error" id="desc_error">* Description</span></td>
  </tr>
  <tr>
    <td>&nbsp;</td>
    <td>&nbsp;</td>
    <td>&nbsp;</td>
    <td>&nbsp;</td>
  </tr>
</table>
<br/>
<button type="submit" id="submit" class="btn btn-blue-alt">Save Record</button>
<span class="loader"><img src="../images/loader.gif" width="50px" height="50px"/>Processing Request...</span>
<div id="response"></div>

</div>